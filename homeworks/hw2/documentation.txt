Програмата се състои от main метод и 4 допълнителни функции:

status_check() - приема реален размер на прочетени/записани байтове и очакван размер и ако има разминаване, хвърля грешка, като преди това затваря отворените файлови дескриптори за четене и писане. Тази функция се извиква след всяко четене и писане с файлов дескриптор.

handle_slot() - чете данни за slot text от read_fd, отпечатва ги по зададен формат на stderr, след което ги записва в write_fd, като read_fd и write_fd са й подадени като аргументи при извикването. Чете 1 байт - идентификатора на слота и го записва в slot. След това следващите 13 прочетени байта ги записва в text. На stderr извейда съобщение с прочетените данни. След това записва в write_fd ms (ако режимът - mode, е record) code, slot и text. 

handle_state() - чете данни за state от read_fd, отпечатва ги по зададен формат на stderr, след което ги записва в write_fd, като read_fd и write_fd са й подадени като аргументи при извикването. Чете в 2 байта активните слотове и запазва резултата в slots. Обръща прочетеното число в binary, като го запазва в масива a. Чете се информация за температурата в 4 байта и се запазва в temp_buf. Превръща се в келвини без умножение по 100 и след това в целзий и се запазва в temp. На stderr се извежда информация за температурата, след което информацията за всеки един слот от а поотделно. След това записва в write_fd ms (ако режимът - mode, е record) code, slots и temp_buf. 

handle_binary() - грижи се за извикването на handle_state() или handle_slot() според зададения й code параметър.

main() - прави проверка за подадения брой аргументи и хвърля грешка при несъответствие. С clock_gettime в start се запазва времето на започване на програмата.
След това се прави проверка за стойността на подадения първи аргумент - record/replay. 
Ако аргументът е replay:
Отваря се или се създава файл с име подаден 2-ри аргумент. С while цикъл се четат по 2 байта от stdin и се запазват в code. Отново с clock_gettime се взима текущото време и се запазва в end. Изчисляват се изминалите секунди между времената в start и end и се запазва в ms. Извиква се функцията handle_binary(), като с нея се четат от stdin следващите данни за съответния код и се записват във файла подаден като 2-ри параметър при извикване на програмата. След завършване на while цикъла, файловият дескриптор за писане се затваря.
Ако аргументът е record:
Отваря се файлът с име подадения 2-ри аргумент. С while цикъл се четат по 8 байта от подадения файл за четене и се запазват в ms. С clock_gettime се взима текущото време и се запазва в end. Четат се по 2 байта с помощта на файловия декскриптор и се запазват в code. Изчисляват се изминалите секунди между времената в start и end и се запазва в ms. В wait_ms се запазва разликата във времената от започване на програмата и записаните ms. Програмата "заспива" за wait_ms милисекунди. С clock_gettime се взима текущото време и се запазва в now. Извиква се функцията handle_binary(), като с нея се четат от файла следващите данни за съответния код и се извеждат на stdout. След завършване на while цикъла, файловият дескриптор за четене се затваря.
